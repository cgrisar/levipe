
<div class="h-36"></div>

<div class="flex container mx-auto flex-col">
  
    {{ partial:login }}
    
    <div class="flex">
        <div class="w-2/5 hidden md:block">
          {{ partial:wine/hero }}
        </div>
        
        <div class="w-full md:w-3/5">

            <div class="w-full lg:w-1/2 mx-4 mb-4">
                {{ partial:wine/wineheader }}
            </div>

            <div class="mx-4 lg:mr-0">
              {{ description }}
            </div>

            <div class="block md:hidden">
              {{ partial:wine/hero }}
            </div>

            <div class="mx-4">

              {{ partial:wine/vintages_list }}

              {{ variants }}
                  <div id="scores-{{ millesime }}" class="flex flex-wrap mb-4 hidden lg:w-1/2">
                    {{ scores }}
                        <div class="w-1/3 pr-2">
                            <img src="{{ theme:images src='{{ guide | lower }}.jpg' }}" class="h-6 w-6 mr-2 -mb-1" />
                            <span class="text-xl font-bold mt-0">{{ score }} / {{ maxscore }}</span>
                        </div>
                    {{ /scores }}
                  </div>
              {{ /variants }}

              <div class="flex flex-col lg:flex-row lg:mr-0">

                  <div id="vintage_descriptions" class="lg:w-1/2">

                    {{ variants }}
                        <div id="description-{{ millesime }}" class="mb-6 hidden">
                            {{ description }}
                        </div>
                    {{ /variants }}

                  <div class="flex items-center mb-6">
                      <a href="https://www.facebook.com/sharer/sharer.php?u=178.66.220.251{{url}}">
                          <i class="fab fa-facebook-f text-blue-darker mr-6"></i>
                      </a>
                      <a href="https://twitter.com/intent/tweet?text=http%3A//178.62.220.251{{url}}">
                          <i class="fab fa-twitter text-blue"></i>
                      </a>
                  </div>

                    {{ partial:comments/meerkat_comments }}

                  </div>
              
            
                  <div class="pl-0 lg:w-1/2 lg:pl-6"  style="min-width:45%">

                      {{ user }}

                        {{ unless no_results }}

                            {{ laradoo:variants_of_a_wine odoowine="{ odoo }" customer="{ email }" as="vintages" }}
                                {{ vintages }}
                                    <div id="vintageprices-{{ millesime }}" class="px-1 py-2 lg:p-2 rounded-lg bg-grey-light">
                                        {{ variants }}
                                            <lvp-variant wine='{{ title }}'
                                                        variant-id="{{ variantId }}" 
                                                        vintage="{{ millesime }}" 
                                                        volume="{{ volume }}" 
                                                        price="{{ price }}" 
                                                        quantity="{{ quantity }}" 
                                                        bo="{{ bo }}" 
                                                        gof="{{ gof }}" 
                                                        bogof_discount="{{ bogof_discount }}"
                                                        bogof_title="{{ trans:cart.bogof bo='{ bo }' gof='{ gof }' bogof_discount='{ bogof_discount }' }}">
                                            </lvp-variant>
                                        {{ /variants }}
                                    </div>
                                {{ /vintages}}
                            {{ /laradoo:variants_of_a_wine }}

                            <!-- only logged in users can comment on a wine -->
                            {{ partial:comments/meerkat_form }}
                          
                        {{ /unless }}

                      {{ /user }}
                      </div>
                  </div>
              </div>
            </div>
        </div>
    </div>
</div>

<!-- script filess -->
{{ section:page_scripts }}

  <script>
      function show_vintages(element) {
          vintage = element.id;
          vintages = document.getElementById("millesimes").getElementsByTagName("li");
      
          // hide all the descriptions and volumes
          [].forEach.call(vintages, function(li) {
              li.getElementsByTagName("div")[0].className = li.getElementsByTagName( "div" )[0].className.replace(/bg-red-darker/g,'bg-grey-lightest');
              li.getElementsByTagName("div")[0].className = li.getElementsByTagName( "div" )[0].className.replace(/text-white/g,'text-red-darker');

              document.getElementById("description-"+li.id).classList.add('hidden');
              if(document.getElementById("vintageprices-"+li.id)){
                  document.getElementById("vintageprices-"+li.id).classList.add('hidden');
              };
              if(document.getElementById("scores-"+li.id)){
                  document.getElementById("scores-"+li.id).classList.add('hidden');
              };
          });
      
          // show the descriptions upon which the vintage was selected
          element.getElementsByTagName("div")[0].className = element.getElementsByTagName("div")[0].className.replace(/bg-grey-lightest/, 'bg-red-darker');
          element.getElementsByTagName("div")[0].className = element.getElementsByTagName("div")[0].className.replace(/text-red-darker/, 'text-white');
          
          document.getElementById("description-" + vintage).classList.remove('hidden');
          if (document.getElementById("vintageprices-" + vintage)) {
              document.getElementById("vintageprices-"+vintage).classList.remove('hidden');
          };
          if (document.getElementById("scores-" + vintage)) {
              document.getElementById("scores-"+vintage).classList.remove('hidden');
          };
      };
    
      ( function() {
          millesimes = document.getElementById("millesimes").getElementsByTagName("li");
          millesimesLastChild = millesimes[ millesimes.length - 1 ];
          // click on it
          millesimesLastChild.click();
      }) ();
  </script>

{{ /section:page_scripts }}