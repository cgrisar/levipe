
<div class="h-36"></div>

<div class="flex container mx-auto flex-col">
  
    {{ partial:login }}
    
    <div class="flex">
      <div class="w-2/5 hidden md:block">
        {{ partial:wine/hero }}
      </div>
      
      <div class="w-full md:w-3/5">

        <div class="w-full lg:w-1/2 mx-4 mb-4">
            {{ partial:wine/wineheader }}
        </div>

        <div class="mx-4 lg:mr-0">
          {{ description }}
        </div>

        <div class="block md:hidden">
          {{ partial:wine/hero }}
        </div>

        <div class="mx-4">

          {{ partial:wine/vintages_list }}

          {{ variants }}
              <div id="scores-{{ millesime }}" class="score flex flex-wrap mb-4 hidden lg:w-1/2">
                {{ scores }}
                    <div class="w-1/3 pr-2">
                        <img src="{{ theme:images src='{ guide }.jpg' }}" class="h-6 w-6 mr-2 -mb-1" />
                        <span class="text-xl font-bold mt-0">{{ score }} / {{ maxscore }}</span>
                    </div>
                {{ /scores }}
              </div>
          {{ /variants }}

          <div class="flex flex-col lg:flex-row lg:mr-0">

              <div id="vintage_descriptions" class="lg:w-1/2">

                {{ variants }}
                    <div id="description-{{ millesime }}" class="description mb-6 hidden">
                        {{ description }}
                    </div>
                {{ /variants }}

                {{ partial:comments/meerkat_comments }}

              </div>
        
              {{ user }}

                {{ unless no_results }}

                  <div class="pl-0 lg:w-1/2 lg:pl-6"  style="min-width:45%">

                    {{ laradoo:variants_of_a_wine odoowine="{ odoo }" customer="{ email }" }}

                        {{ vintages }}
                            <div id="vintageprice-{{ millesime }}" class="vintageprice rounded-lg bg-grey-light">

                                <div class="px-1 py-2 lg:p-2">
                                  {{ variants }}
                                    <lvp-variant wine='{{ title }}'
                                                variant-id="{{ variantId }}" 
                                                vintage="{{ millesime }}" 
                                                volume="{{ volume }}" 
                                                price="{{ price }}" 
                                                quantity="{{ quantity }}" 
                                                bo="{{ bo }}" 
                                                gof="{{ gof }}" 
                                                bogof_discount="{{ bogof_discount }}"
                                                bogof_title="{{ trans:cart.bogof bo='{ bo }' gof='{ gof }' bogof_discount='{ bogof_discount }' }}">
                                    </lvp-variant>
                                  {{ /variants }}
                                </div>

                            </div>
                        {{ /vintages}}

                    {{ /laradoo:variants_of_a_wine }}

                    <!-- only logged in users can comment on a wine -->
                    {{ partial:comments/meerkat_form }}
                  
                  </div>
                  
                {{ /unless }}

              {{ /user }}
        
          </div>
        </div>
      </div>
    </div>
</div>

<!-- script filess -->
{{ section:page_scripts }}

  <script>
      function show_vintages(element) {
          vintage = element.id;
          vintages = document.getElementById("millesimes").getElementsByTagName("li");
      
          // hide all the descriptions and volumes
          [].forEach.call(vintages, function(li) {
              li.getElementsByTagName("div")[0].className = li.getElementsByTagName( "div" )[0].className.replace(/bg-red-darker/g,'bg-grey-lightest');
              li.getElementsByTagName("div")[0].className = li.getElementsByTagName( "div" )[0].className.replace(/text-white/g,'text-red-darker');

              document.getElementById("description-"+li.id).classList.add('hidden');
              if(document.getElementById("vintageprices-"+li.id)){
                  document.getElementById("vintageprices-"+li.id).classList.add('hidden');
              };
              if(document.getElementById("scores-"+li.id)){
                  document.getElementById("scores-"+li.id).classList.add('hidden');
              };
          });
      
          // show the descriptions upon which the vintage was selected
          element.getElementsByTagName("div")[0].className = element.getElementsByTagName("div")[0].className.replace(/bg-grey-lightest/, 'bg-red-darker');
          element.getElementsByTagName("div")[0].className = element.getElementsByTagName("div")[0].className.replace(/text-red-darker/, 'text-white');
          
          document.getElementById("description-" + vintage).classList.remove('hidden');
          if (document.getElementById("vintageprices-" + vintage)) {
              document.getElementById("vintageprices-"+vintage).classList.remove('hidden');
          };
          if (document.getElementById("scores-" + vintage)) {
              document.getElementById("scores-"+vintage).classList.remove('hidden');
          };
      };
    
      ( function() {
          millesimes = document.getElementById("millesimes").getElementsByTagName("li");
          millesimesLastChild = millesimes[ millesimes.length - 1 ];
          // click on it
          millesimesLastChild.click();
      }) ();
  </script>

{{ /section:page_scripts }}